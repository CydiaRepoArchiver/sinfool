#!/bin/bash

cd /var/mobile/sinfool
echo -e "This automatically generated list should contain the name, package identifier, version, and description of each package on this repo \n————— \n \n" > tweaks.txt
ls debs | while read d
do
p=debs/"$d"
dpkg-deb -f $p >> Packages
echo "Filename: $p" >> Packages
echo "MD5sum: $(md5sum $p | cut -d " " -f1)" >> Packages
echo "Size: $(stat -c %s $p)" >> Packages
echo >> Packages
echo "Name: $(dpkg-deb -f $p Name)" >> tweaks.txt
echo "Identifier: $(dpkg-deb -f $p Package)" >> tweaks.txt
echo "Version: $(dpkg-deb -f $p Version)" >> tweaks.txt
echo "Description: $(dpkg-deb -f $p Description)" >> tweaks.txt
echo -e "\n————— \n" >> tweaks.txt
done
bzip2 -zf Packages
echo "Currently $(ls debs | wc -l) packages on this repo" > readMe.md
echo >> readMe.md
echo "$(ls debs | grep -vc "debug") have been approved by our team as \"ready for use\"" >> readMe.md
git add --all
test "$1" = "" && git commit -m "Update" || git commit -m "$1"
sudo git push